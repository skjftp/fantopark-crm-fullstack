/* Mobile Scroll Fix for CRM */

/* Fix for mobile viewport and scrolling issues */
@media (max-width: 768px) {
  /* Reset HTML and Body for proper mobile viewport */
  html, body {
    height: 100%;
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
  
  /* Main app container */
  #root, .app-wrapper, body > div:first-child {
    height: 100%;
    overflow: hidden;
    position: relative;
  }
  
  /* Fix the main scrollable container */
  .flex-1.overflow-auto {
    position: fixed !important;
    top: 60px !important; /* Account for mobile header */
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    z-index: 1;
  }
  
  /* Ensure content inside scrollable area has proper spacing */
  .flex-1.overflow-auto > div {
    padding-bottom: 100px !important; /* Extra padding to ensure last content is visible */
    min-height: calc(100% + 1px); /* Force scrollbar if needed */
  }
  
  /* Fix for cards and containers */
  .bg-white.rounded-lg.shadow,
  .bg-gray-800.rounded-lg.shadow,
  [class*="rounded-lg shadow"] {
    margin-bottom: 20px !important;
  }
  
  /* Fix for nested scrollable containers */
  .overflow-y-auto {
    max-height: calc(100vh - 120px) !important; /* Leave room for headers */
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Specific fix for lead cards and similar scrollable lists */
  .space-y-4,
  [class*="space-y-"] {
    padding-bottom: 50px !important;
  }
  
  /* Fix for table containers */
  .table-container,
  .overflow-x-auto {
    max-height: calc(100vh - 150px) !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    padding-bottom: 50px !important;
  }
  
  /* Ensure modals work properly */
  .fixed.inset-0 {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  /* Modal content scrolling */
  [role="dialog"] .overflow-y-auto {
    max-height: calc(100vh - 100px) !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Fix for inventory and similar grid views */
  .grid {
    padding-bottom: 50px !important;
  }
  
  /* Mobile header should be fixed */
  .mobile-header {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 60px !important;
    z-index: 40 !important;
  }
  
  /* Sidebar fixes for mobile */
  .sidebar, .w-64 {
    position: fixed !important;
    top: 0 !important;
    bottom: 0 !important;
    height: 100vh !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Remove any absolute positioning that might interfere */
  .absolute:not(.modal-backdrop):not([role="dialog"]) {
    position: relative !important;
  }
  
  /* Ensure touch scrolling works */
  * {
    -webkit-overflow-scrolling: touch !important;
  }
  
  /* Fix for tab content */
  .tab-content-wrapper {
    height: 100% !important;
    overflow: hidden !important;
  }
  
  .tab-inner-content {
    height: 100% !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    padding-bottom: 100px !important;
  }
}

/* Additional fixes for iOS Safari */
@supports (-webkit-touch-callout: none) {
  @media (max-width: 768px) {
    /* iOS specific fixes */
    .flex-1.overflow-auto {
      height: calc(100vh - 60px) !important;
      height: calc(100vh - 60px - env(safe-area-inset-bottom)) !important;
      position: absolute !important;
    }
    
    /* Account for iOS bottom bar */
    .flex-1.overflow-auto > div {
      padding-bottom: calc(100px + env(safe-area-inset-bottom)) !important;
    }
  }
}

/* Fix for Android Chrome */
@media (max-width: 768px) and (display-mode: browser) {
  .flex-1.overflow-auto {
    height: calc(100vh - 60px) !important;
    height: calc(100dvh - 60px) !important; /* Dynamic viewport height */
  }
}

/* Ensure last item in lists is visible */
@media (max-width: 768px) {
  /* Add spacing after last child in scrollable containers */
  .overflow-y-auto > :last-child,
  .overflow-auto > :last-child,
  .space-y-4 > :last-child,
  .grid > :last-child {
    margin-bottom: 80px !important;
  }
  
  /* Fix for specific components */
  #leads-content > :last-child,
  #inventory-content > :last-child,
  #orders-content > :last-child {
    margin-bottom: 100px !important;
  }
}
